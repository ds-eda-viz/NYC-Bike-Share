<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Data transformation | NYC-Citibike</title>
  <meta name="description" content="Chapter 3 Data transformation | NYC-Citibike" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Data transformation | NYC-Citibike" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Data transformation | NYC-Citibike" />
  
  
  

<meta name="author" content="Xiaonan Guo(xg2308), Gaoyi Shi (g32012), Kenny Jin (jj3134), Jiayin Lin (jl5802)" />


<meta name="date" content="2020-12-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-sources.html"/>
<link rel="next" href="missing-values.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>



<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">NYC-citibike</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="data-sources.html"><a href="data-sources.html"><i class="fa fa-check"></i><b>2</b> Data sources</a></li>
<li class="chapter" data-level="3" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>3</b> Data transformation</a></li>
<li class="chapter" data-level="4" data-path="missing-values.html"><a href="missing-values.html"><i class="fa fa-check"></i><b>4</b> Missing values</a><ul>
<li class="chapter" data-level="4.1" data-path="missing-values.html"><a href="missing-values.html#missing-values-by-column-and-row"><i class="fa fa-check"></i><b>4.1</b> Missing values by Column and Row</a></li>
<li class="chapter" data-level="4.2" data-path="missing-values.html"><a href="missing-values.html#missing-pattern-by-year-and-month"><i class="fa fa-check"></i><b>4.2</b> Missing pattern by Year and Month</a></li>
<li class="chapter" data-level="4.3" data-path="missing-values.html"><a href="missing-values.html#dealing-with-missing-values"><i class="fa fa-check"></i><b>4.3</b> Dealing with missing values</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="results.html"><a href="results.html"><i class="fa fa-check"></i><b>5</b> Results</a><ul>
<li class="chapter" data-level="5.1" data-path="results.html"><a href="results.html#the-membership-analysis-age-gender-annual-memberships-or-subscriber"><i class="fa fa-check"></i><b>5.1</b> The Membership analysis (Age, Gender, Annual memberships or Subscriber)</a></li>
<li class="chapter" data-level="5.2" data-path="results.html"><a href="results.html#time-series-on-bike-usage-2018--2020"><i class="fa fa-check"></i><b>5.2</b> Time Series on Bike Usage (2018 -2020)</a></li>
<li class="chapter" data-level="5.3" data-path="results.html"><a href="results.html#weekdayweekend-usage"><i class="fa fa-check"></i><b>5.3</b> Weekday/Weekend Usage</a></li>
<li class="chapter" data-level="5.4" data-path="results.html"><a href="results.html#temerature-affects-on-the-bike-usage"><i class="fa fa-check"></i><b>5.4</b> Temerature affects on the Bike usage</a></li>
<li class="chapter" data-level="5.5" data-path="results.html"><a href="results.html#bike-users-route-patternhow-people-use-it-as-the-commute-tool"><i class="fa fa-check"></i><b>5.5</b> Bike Users’ route pattern(How people use it as the commute tool)</a></li>
<li class="chapter" data-level="5.6" data-path="results.html"><a href="results.html#top-popular-stations-by-year"><i class="fa fa-check"></i><b>5.6</b> Top Popular stations by year</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="interactive-component.html"><a href="interactive-component.html"><i class="fa fa-check"></i><b>6</b> Interactive component</a></li>
<li class="chapter" data-level="7" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>7</b> Conclusion</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">NYC-Citibike</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-transformation" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Data transformation</h1>
<p><strong>Part 1 Outliers </strong><br />
Based on the variable descriptions in section 2, we want to look into more details to check if there are any outliers and for those outliers, whether they are purely wrong data input that we can remove or if we need to correct data. Identifying outliers by plotting helps analysis. Boxplots and bar charts were created for this purpose.</p>

<p>Especially We want to check tripduration and age. One month bike trip data 201906 was randomly selected to analyze the outliers.</p>
<pre><code>## &#39;data.frame&#39;:    2125370 obs. of  17 variables:
##  $ tripduration           : int  330 830 380 1155 1055 128 315 471 1554 392 ...
##  $ starttime              : chr  &quot;2019-06-01 00:00:01.5000&quot; &quot;2019-06-01 00:00:04.2400&quot; &quot;2019-06-01 00:00:06.0190&quot; &quot;2019-06-01 00:00:06.7760&quot; ...
##  $ stoptime               : chr  &quot;2019-06-01 00:05:31.7600&quot; &quot;2019-06-01 00:13:55.1470&quot; &quot;2019-06-01 00:06:26.7790&quot; &quot;2019-06-01 00:19:22.5380&quot; ...
##  $ start.station.id       : int  3602 3054 229 3771 441 3236 3129 3467 379 467 ...
##  $ start.station.name     : chr  &quot;31 Ave &amp; 34 St&quot; &quot;Greene Ave &amp; Throop Ave&quot; &quot;Great Jones St&quot; &quot;McKibbin St &amp; Bogart St&quot; ...
##  $ start.station.latitude : num  40.8 40.7 40.7 40.7 40.8 ...
##  $ start.station.longitude: num  -73.9 -73.9 -74 -73.9 -74 ...
##  $ end.station.id         : int  3570 3781 326 3016 3159 495 3560 401 2006 3368 ...
##  $ end.station.name       : chr  &quot;35 Ave &amp; 37 St&quot; &quot;Greene Av &amp; Myrtle Av&quot; &quot;E 11 St &amp; 1 Ave&quot; &quot;Kent Ave &amp; N 7 St&quot; ...
##  $ end.station.latitude   : num  40.8 40.7 40.7 40.7 40.8 ...
##  $ end.station.longitude  : num  -73.9 -73.9 -74 -74 -74 ...
##  $ bikeid                 : int  20348 34007 20587 33762 31290 25137 25648 26972 32969 33539 ...
##  $ usertype               : chr  &quot;Subscriber&quot; &quot;Subscriber&quot; &quot;Subscriber&quot; &quot;Subscriber&quot; ...
##  $ birth.year             : int  1992 1987 1990 1987 1973 1989 1995 1990 1970 1980 ...
##  $ gender                 : int  1 2 2 1 1 1 1 1 1 1 ...
##  $ age                    : num  28 33 30 33 47 31 25 30 50 40 ...
##  $ year_month             : chr  &quot;201906&quot; &quot;201906&quot; &quot;201906&quot; &quot;201906&quot; ...</code></pre>
<p><img src="finalproj_files/figure-html/unnamed-chunk-4-1.png" width="672" />
From above boxplot, we see a lot of outliers, there are some abanomal trip duration, we want to bin the tripduration to check in more details.</p>
<p><img src="finalproj_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>From vertical bar chart, we can see most of the trips are less than 1 hour, and a few trip between 1 to 24 hours. For trips more than 24 hours, we define them as outliers and removed associated rows. It’s possible for the trip more than 12 hours, for example, it starts at 5:00 am and ends at 9:00pm if a person is interested to tour the whole Mahattan from north to south and from east to west. However, for trips more than 1 day, they are very rare cases. There are many different reasons that cause the trip more than 24 hours, for example, system error, the bike is stolen or a person forgot to return the bike…<br />

Next we look into ages.</p>
<p><img src="finalproj_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p><img src="finalproj_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p><img src="finalproj_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>

<p>From the boxlpot and histogram, we can see most of the trips made by age between 20 and 70. However, there some abnoraml ages which are even more than 120.<br />
To better present the data for further analysis, we define age above 100 as outliers and removed those data.<br />
Also, another boundary to mention, according to the rental agreement, ‘You may not ride a Bicycle if You are under 16 years of age. A minor who is 16 years of age or older may only use the Services if the minor’s subscription is purchased by, and the minor is under the responsibility of, the minor’s parent or legal guardian.’ <a href="https://assets.citibikenyc.com/rental-agreement.html" class="uri">https://assets.citibikenyc.com/rental-agreement.html</a> We checked data range, there is no record for age below 16.</p>

<p>To summarize, we have defined tripduration more than 24 hours and age above 100 years old as outliers and removed those rows.</p>
<p><strong>Part 2 Data Transformation</strong></p>
<p>[Since each file contains more than Million rows, it’s very slow to perform data transformation in R. We used Mysql server to process our data, all the SQL code have been used to generate datasets are located here:] <a href="https://github.com/xguo7013/NYC-Bike-Share/tree/main/sql" class="uri">https://github.com/xguo7013/NYC-Bike-Share/tree/main/sql</a></p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-sources.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="missing-values.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ds-eda-viz/NYC-Bike-Share/edit/main/03-cleaning.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/ds-eda-viz/NYC-Bike-Share/blob/main/03-cleaning.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
